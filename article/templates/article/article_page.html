{% extends "_base.html" %}
{% load wagtailimages_tags %}
{% load static %}
{% load jalali_tags %}
{% load wagtailcore_tags%}
{% load crispy_forms_tags %}

{% block head %}
    <link rel="stylesheet" href="{% static 'css/article.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="rounded-1">
        <div class="d-flex justify-content-center">
            <h1 class="mt-4 text-gold">{{ page.title }}</h1>
        </div>
        <div class="d-flex justify-content-center mt-3">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">
                <path d="M6 1L6 3L5 3C3.9 3 3 3.9 3 5L3 19C3 20.1 3.9 21 5 21L19 21C20.1 21 21 20.1 21 19L21 5C21 3.9 20.1 3 19 3L18 3L18 1L16 1L16 3L8 3L8 1L6 1 z M 5 8L19 8L19 19L5 19L5 8 z M 13 13L13 17L17 17L17 13L13 13 z" fill="#786600ff" />
            </svg>
            {% if page.first_published_at%}
                <p class="mx-2 text-date text-gold fw-bold">
                    {{ page.first_published_at | to_jalali:'%Y/%m/%d' }}
                </p>
            {% else %}
                <p class="mx-2 text-date">1404/04/04</p>
            {% endif %}
        </div>
        <hr class="border border-1 border-warning"> </hr>
    </div>
    <div class="row">
        <div class="col-sm-8 col-12">
            <div class="rounded-1 glass-element mb-4 border border-1 border-warning p-2">
                <div>
                    {% srcset_image page.image height-{300,400} style="max-height:500px; object-fit:fill;" class="img-fluid w-100 rounded-1 border border-1 border-silver" alt="page.image.caption" %}
                </div>
                <div class="my-2">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25">
                        <path d="M11.586,3.586l-9,9c-0.781,0.781-0.781,2.047,0,2.828l6,6c0.781,0.781,2.047,0.781,2.828,0l9-9 C20.789,12.039,21,11.53,21,11V5c0-1.105-0.895-2-2-2h-6C12.47,3,11.961,3.211,11.586,3.586z M17.5,8C16.672,8,16,7.328,16,6.5 S16.672,5,17.5,5S19,5.672,19,6.5S18.328,8,17.5,8z" fill="#005bf8ff">
                    </svg>
                    {% for tag in page.tags.all %}
                        <span class="text-primary">{{ tag.name }}{% if not forloop.last %}، {% endif %}</span>
                    {% endfor %}
                </div>
                <div>
                    {{ page.body|richtext }}
                </div>
                <hr class="border border-1 border-warning"> </hr>
                <div>
                    {% if page.category %}
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="25" height="25">
                            <path d="M5 5L5 7L27 7L27 5 Z M 5 10L5 12L24 12L24 10 Z M 5 15L5 17L21 17L21 15 Z M 5 20L5 22L18 22L18 20 Z M 5 25L5 27L15 27L15 25Z" fill="#a08300ff" />
                        </svg>
                        <span class="text-gold fw-bold">دسته‌بندی: </span>
                        <a class="text-decoration-none" herf="#" style="cursor: pointer;">{{ page.category.name }}</a>
                    {% endif %}
                </div>
            </div>
            <div class="rounded-1 glass-element mb-4 border border-1 border-warning p-2">
                <form method="post">
                    {% csrf_token %}
                    {{ form | crispy }}
                    <button type="submit" class="btn btn-primary">ارسال نظر</button>
                </form>
            </div>
            {% if comments%}
                <div class="glass-element border border-1 border-warning mb-2 rounded-1 p-2">
                <h3>نظرات:</h3>
                {% for comment in comments %}
                    <div class="rounded-1 p-3 border border-1 border-silver my-2">
                        <div class="mb-3">
                            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEG0lEQVR4nO3WW09cVRTA8UmsiQ+NX8D64MM5AwMNDwSNkoqaqBQasRcq4LU0NvGhNBJTiEDOZoZ0CoU6heHSYQZaENoChRFwCFAKVEBAhuEOhQKFaqs12pD4/jdHJUEz5wzTmhiTrg9wfmvts9Ze22B4HP+nyHHzgtKOLa2BvtQafO9VczvJxa0kF4MpVbSk1pHxfiWh/zqseIjLamX4wHkeROTxkyT4QRasSYIVWbAkKSzIglmTmenoQqZj7VyOtRH16HA1T1k8uA862DDm8rOs8KMWLilMyQKfpDAmC4YjrXwbXUBmjMKOh8LzrvGMaGf8+XweSCI4XBIMygo3jIK+MDNFJoWdQVee+zXecMvD45KgV1K4Jgs6w82cCeokLB7cgSoPNTP7RjELrxczGyK24OLvuKTgMebSFlXAJ9vCc9qJP+BgQw8/3sDawDIbo7fZ6Fvk16Zx7iVXM+EPlwVtkoI7wsrVl21IARPI+ooRvYZLa2B96nt+28Q757jvnuTu5THWD1Uy6g+XBU2S4Mqes+Tq4pnNvKiOmhYebmFua+Vb8Du1I6w6B7llMtPlD5cV6iOtXEoo5VnNBISHc3pznljJohZe/x2rjV5W40rp9YdLglpTLhf3OzikmUBaA3163X60lkU9vGWSleQq+v3hssIFSeDaZydbM4EjtUzqjdpb5czo4e3TrMSX0qWFywqOvXbOaCaQUsWq3pyHmRmpG+WOFt7g5WZoLle1cElQHl9GhWYCh10sBbpkklx4a/zgnhlWjtTSo4fLgpK3KyjVTOAdF0O6N9xfc55YyXD1EItbK0/dBi4r2A47sWomkFxFcyB8c86NAs8rZ+l69Qs6Qsza/3wrLgmKPqohQzOB1Doy1JUaCNea80B4RB6FnzZxUDOBd50Y1X2uh79moyfDzcjpTrzFvYwX9TCa3Ur/sXo8LxX8kYRfXFYoiCulJL1F5yJSY28pNf7wDy8y3D3P+sQ690dWuTuwzNr1BZY7ZrjpnmSm0ctE8wQ+xwAD+x3U/RM3mrGmXeJzQ6BIKGF3pJWhTTxE0KM23Pw9fgmEt03h88zi65rDV9BNu9H8Jy4JrAkV2LLdGA3biehCMtXHhFp5phtfMHj3PL6eBXz9S0ycaORLFY+ykn+ymY8N240YhR1hFgrVfx4i6Dh3nalgcXsv7WEWTu+2cCr9KjnHxnjSEEyYFHaazOSrjwm121Oq6aobZSoQfmWM/g8u4Nys/LNmso7X8nRQ+NaTUF8y6mNic9TetNN0opGO/C56HQN84xzkhr2P7uxWmveVcX6z4RLKsKnHntjAE4ZHjT3FPBdTSI66z9WVqjfn6qip3b7thgsmYh3sUve5ulLVraYuloRyyhKdnFJvuPRGEk962BXURx+H4T+O3wGCINhgVtSO9QAAAABJRU5ErkJggg==" alt="user-male-circle">
                            <span class="fw-bold">{{ comment.display_name }}</span>
                        </div>
                        <div class="white-glass rounded-2 px-2 pb-2 pt-1">
                            <p class=>{{ comment.content }}</p>
                        </div>
                        <p class="text-date text-silver text-start mt-2 mb-0">
                            {{ comment.created_at | to_jalali:'%H:%M - %Y/%m/%d' }}
                        </p>
                    </div>
                {% endfor %}
                </div>
            {% endif %}
        </div>
        <div class="col-sm-4 col-12">
            <div class="glass-element rounded-1 border border-1 border-warning">
                <div class="rounded-1 mb-2 p-2">
                    <div class="glass-element p-2 rounded-2 border border border-silver text-center">
                        <h4 class="text-center fs-5">پست‌های اخیر</h4>
                    </div>
                </div>
                {% for new_article in latest_articles %}
                    <div class="row px-2 mb-3 g-3">
                        <div class="col-5">
                            <a href="{{ new_article.url }}">
                                {% srcset_image new_article.image height-{300,400} style="height:75px; object-fit:fill;" class="img-fluid rounded-3 border border-1 border-silver" alt="new_article.image.caption" %}
                            </a>
                        </div>
                        <div class="col-7">
                            <a href="{{ new_article.url }}" class="text-mod text-decoration-none"> {{ new_article.title }} </a>
                        </div>
                    </div>
                {% endfor %}
            </div>

        </div>
    </div>
</div>
{% endblock %}